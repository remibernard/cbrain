
<%-
#
# CBRAIN Project
#
# Copyright (C) 2008-2012
# The Royal Institution for the Advancement of Learning
# McGill University
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
#
-%>


<%= render :partial => 'shared/active_filters', :locals => {:model => :cbrain_task} %>


<div class="pagination">
  <%= render :partial => "pagination" %>
</div>

<%=
  index_table(@paginated_list, :class => "resource_list", :id => "tasks_table") do |t|
    t.column(select_all_checkbox "task_checkbox")
    t.sort_column("Task Type", 'CbrainTask', 'type', :filters => basic_filters_for(@filtered_scope, @header_scope, CbrainTask, :type)) { |t| t.pretty_name }
    t.sort_column("Description", 'CbrainTask', 'description', :class => "left shrinkable")
    t.sort_column("Owner", 'User', 'login', :filters => association_filters_for(@filtered_scope, @header_scope, CbrainTask, :user, :name_method => :login))
    unless current_project
      t.sort_column("Project", 'Group', 'name', :filters => association_filters_for(@filtered_scope, @header_scope, CbrainTask, :group))
    end
    t.sort_column("Execution Server", 'RemoteResource', 'name', :filters => association_filters_for(@filtered_scope, @header_scope, CbrainTask, :bourreau, :association_table => :remote_resources))
    t.sort_column("Current Status", 'CbrainTask', 'status', :filters => basic_filters_for(@filtered_scope, @header_scope, CbrainTask, :status))
    t.column("Run Number")
    t.sort_column("Workdir Size", 'CbrainTask', 'cluster_workdir_size')
    t.reverse_sort_column("Time Submitted", 'CbrainTask', 'created_at')
    t.reverse_sort_column("Last Updated", 'CbrainTask', 'updated_at')
    t.row_override do |batch_id|
      render :partial => 'tasks/batch_view', :locals => {:batch_id => batch_id}
    end
  end
%>

<%= center_legend("Workdir archiving status symbols:", [
      [ colored_archived_status(:workdir),  "On Cluster"  ],
      [ colored_archived_status(:userfile), "As File"     ],
    ])
%>

